# A I: 우리 아이 지킴이 어플리케이션

2021 CDIC 두산 인프라코어 캡스톤 디자인 공모전

[Backend-Django](https://github.com/Seoha-Yoon/ai_guardians_backend)

* Team M-idle

|이름|역할|
|---|---|
|김민구|음성 모델 개발 및 훈련|
|신선우|영상 모델 개발 및 훈련, PPT 제작|
|윤서하|팀장, 모바일 클라이언트/백엔드 개발|
|이민정|영상 모델 개발 및 훈련, 발표|

### 1. 과제 요약
 어린이집 내 CCTV 설치 의무화를 실행 중임에도 불구하고, 여전히 아동학대의 위험이 끊이지 않고 있다.CCTV가 있음에도 감시하는 사람이 따로 없기 때문에 빠른 대처를 하지 못 한다는 점과 학대 증거를 직접 찾아야만 하는 점은 CCTV 설치 의무화 법안의 실효성에 대한 의심을 들게 한다. 따라서 우리는 학대 위험에 놓여있는 아이들을 위하여 "인공지능을 활용한 실시간 CCTV 영상 내 아동학대 감지 및 알림 시스템"을 제안한다.
 
 우리가 제안한 시스템의 흐름은 다음과 같다. 어린이집 내 CCTV 영상에서 음성과 영상을 통해 아동 학대가 발생했는지 판단하고 그 장면을 검출한다. 검출된 장면이 특정 임계값 이상이고, 폭력에 가까운 음성이라 판단되면 해당 장면을 알림과 함께 보호자(부모 혹은 보호관)에게 전송한다. 이를 통하여 보호자가 곧바로 학대 아동에 대한 조치를 취할 수 있도록 도와준다.  CCTV 영상 내에 폭력을 검출할 때 사용되는 Separable CNN-LSTM 모델[2]은 관련 벤치마크 데이터셋에서 기존의 모델들 보다 빠른 연산속도와 높은 정확도를 가지고 있다. 영상 모델은 Google Colab Pro 환경에서 학습하였으며 한 epoch당 약 1800초씩 총 134번의 epoch를 실행했다. 또한, 폭력 음성 분류 모델을 추가하여 영상 모델의 단점을 보완함과 동시에 폭력 검출 정확도를 향상 시켰다.
 
 해당 시스템은 적은 초기비용으로 감지된 아동학대에 관해 신속하게 처리할 수 있다. 또한 아동 학대 뿐만 아니라 다양한 형태의 폭력에도 적용 될 수 있을 것이라 기대한다.
 
### 2. 과제 수행과정
1. 인공지능 학습에 필요한 어린이 집의 폭력, 비폭력 데이터들을 수집한다. 폭력 데이터는 AI hub에 있는 폭행 데이터와 인터넷에 공개되어 있는 성인이 어린이를 학대하는 영상 데이터 등을 사용한다. 비폭력 데이터는 AI hub의 폭행 데이터 내 일상 대화하는 부분을 잘라서 사용한다. 음성 데이터 또한 인터넷에 공개된 데이터를 수집한다.
2. 영상 및 음성에 대한 데이터 증강 및 전처리를 수행한다.
3. 딥러닝 모델을 이용하여 폭력적인 행동이 담긴 영상 및 학대가 유추되는 음성을 학습시킨다. 영상 모델은  텐서플로우를 이용한 Separable CNN-LSTM 모델을 사용하고, 음성 모델은 다층 퍼셉트론을 활용한다.
4. 각각의 모델에 input을 넣기 전, CCTV 영상에서 음성을 따로 추출하여 저장한다.
5. CCTV 영상을 영상 모델에 넣어 해당 영상의 폭력 유사도를 확인하고, 추출된 음성을 음성 모델에 넣어 음성이 분류된 클래스를 확인한다.
6. 검출된 장면에서 폭력 유사도가 일정 임계값 이상이고, 음성 클래스가 폭력 클래스이면, 해당 장면을 모바일 어플리케이션으로 알림과 함께 보호자에게 전송한다.
7. 이를 수신한 보호자는 112에 신고하는 등 학대 피해 아동을 위한 보호 조치를 마련한다.

### 3. 시스템 구성도
![KakaoTalk_Photo_2021-10-07-17-07-14-1](https://user-images.githubusercontent.com/60412023/148174813-dfc4135f-bf60-4113-81c9-18efb7774b56.png)

### 4. 모델 아키텍처
![KakaoTalk_Photo_2021-10-07-17-07-14-3](https://user-images.githubusercontent.com/60412023/148176017-c5aa3de3-1b15-4ec3-ad20-9566c8912f73.png)
